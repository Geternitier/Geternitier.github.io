

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon/yuanshen.jpeg">
  <link rel="icon" href="/image/icon/yuanshen.jpeg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#5a9367">
  <meta name="author" content="Geternitier">
  <meta name="keywords" content="">
  
    <meta name="description" content="不畏浮云遮望眼，自缘身在最高层">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机操作系统-第四章_设备管理">
<meta property="og:url" content="http://example.com/2023/05/04/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E5%9B%9B%E7%AB%A0%20%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="Geternitier的博客">
<meta property="og:description" content="不畏浮云遮望眼，自缘身在最高层">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-05-04T04:00:00.000Z">
<meta property="article:modified_time" content="2023-06-20T22:40:24.306Z">
<meta property="article:author" content="Geternitier">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>计算机操作系统-第四章_设备管理 - Geternitier的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Geternitier的博客" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Geternitier的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/image/background/TheSpirits.webp') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="计算机操作系统-第四章_设备管理"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-05-04 12:00" pubdate>
          2023年5月4日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          5.9k 字
        
      </span>
    

    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">计算机操作系统-第四章_设备管理</h1>
            
            
              <div class="markdown-body">
                
                <p>不畏浮云遮望眼，自缘身在最高层</p>
<span id="more"></span>
<h1 id="第四章-设备管理">第四章 设备管理</h1>
<h2 id="设备管理基础">4.1 设备管理基础</h2>
<h3 id="设备管理概述">4.1.1 设备管理概述</h3>
<h4 id="输入输出设备及其分类">1. 输入/输出设备及其分类</h4>
<ul>
<li><p>输入/输出设备，又称外围设备、外设，用于计算机系统与外部世界的信息交换或存储。</p></li>
<li><p>输入/输出操作：内存和外设间的信息传送操作</p>
<ul>
<li>影响计算机系统的通用性和可扩展性</li>
<li>影响计算机系统综合处理能力及性价比</li>
</ul></li>
</ul>
<p>输入/输出设备分类：</p>
<ul>
<li>信息传输视角：分为输入设备、输出设备和输入输出设备</li>
<li>交互功能视角：分为人机交互设备、存储设备和机机通信设备</li>
<li>设备管理视角：分为字符设备、块设备和网络设备</li>
</ul>
<h4 id="设备管理的目标">2. 设备管理的目标</h4>
<p>解决设备和CPU速度的不匹配，使主机和设备充分并行工作，提高设备使用效率。</p>
<p>屏蔽设备的物理细节和操作过程，配置驱动程序，提供同一界面。</p>
<ul>
<li>抽象为裸设备</li>
<li>抽象为设备文件</li>
</ul>
<h4 id="设备管理的功能">3. 设备管理的功能</h4>
<ul>
<li>设备中断管理</li>
<li>缓冲区管理</li>
<li>设备的分配与去配</li>
<li>设备驱动调度</li>
<li>虚拟设备的实现</li>
</ul>
<h4 id="设备管理的实现层次">4. 设备管理的实现层次</h4>
<ul>
<li>输入/输出硬件
<ul>
<li>输入/输出设备及其接口线路</li>
<li>控制部件</li>
<li>通道</li>
</ul></li>
<li>输入/输出软件
<ul>
<li>系统输入/输出软件</li>
<li>用户空间输入/输出软件</li>
</ul></li>
</ul>
<h3 id="输入输出控制方式">4.1.2 输入/输出控制方式</h3>
<h4 id="设备控制器">1. 设备控制器</h4>
<p>为达到模块化和通用性的设计目标，通常分开设置设备的机械部件和电子部件。</p>
<p>电子部件成为设备控制器，又称为设备适配器、输入/输出控制器(模块/接口等)。</p>
<p>系统与控制器交互，而非与设备交互，设备控制器具体控制设备进行输入/输出。</p>
<h5 id="设备控制器的功能">设备控制器的功能</h5>
<p>设备控制器是CPU与设备之间的接口。</p>
<ul>
<li>接受和识别CPU或通道发来的命令</li>
<li>实现数据交换</li>
<li>发现和记录设备及其自身的状态信息，供CPU处理时使用</li>
<li>当连接多台设备时，识别设备地址</li>
</ul>
<h4 id="三种基本输入输出控制方式">2. 三种基本输入/输出控制方式</h4>
<h5 id="轮询方式">轮询方式</h5>
<ul>
<li>处理器向控制器发送输入/输出命令，轮询输入/输出结果</li>
<li>若设备未就绪，则重复测试过程，直至设备就绪</li>
<li>执行内存数据交换</li>
<li>等待输入/输出操作完成后，处理器才可以继续其他操作</li>
</ul>
<h5 id="中断方式">中断方式</h5>
<ul>
<li>处理器向控制器发出具体输入/输出命令，然后继续执行后续指令
<ul>
<li>若进程支持异步输入/输出，后续指令仍然可以是该进程中指令</li>
<li>否则该进程在这个中断上挂起，处理器执行其他工作</li>
</ul></li>
<li>控制器检查设备状态，就绪后发出中断</li>
<li>CPU响应中断，进行中断处理，执行内存数据交换</li>
</ul>
<h5 id="dmadirect-memory-access直接存储器访问方式">DMA（Direct Memory
Access，直接存储器访问）方式</h5>
<p>DMA模块：替代处理器来控制主存和设备控制器间的数据交换</p>
<ul>
<li>处理器向DMA模块发出输入/输出命令</li>
<li>处理器继续执行其他工作，DMA模块负责传送全部数据</li>
<li>数据传送结束后，DMA中断处理器</li>
</ul>
<h5 id="dma方式中的周期窃取">DMA方式中的周期窃取</h5>
<p>DMA和CPU同时通过总线访问内存，CPU会把总线的占有权让给DMA一个或几个主存周期。</p>
<p>周期窃取对CPU与主存的数据交换影响不大</p>
<ul>
<li>数据传送过程是不连续、不规则的</li>
<li>CPU大部分情况下与Cache进行数据交换，直接访问内存较少</li>
</ul>
<p>总结：</p>
<ul>
<li>轮询：CPU等待设备就绪，参与内存数据交换</li>
<li>中断：CPU不等待设备就绪，响应中断后参与内存数据交换</li>
<li>DMA：CPU不等待设备就绪，不参与主存数据交换</li>
</ul>
<h4 id="输入输出通道及其工作方式">3. 输入/输出通道及其工作方式</h4>
<h5 id="输入输出通道">输入/输出通道</h5>
<p>又称为通道控制器、输入/输出处理器，用于完成逻辑上独立的输入/输出任务。</p>
<p>采用四级连接：处理器、通道、控制器、设备</p>
<ul>
<li>通道可控制多台同类或不同类设备</li>
</ul>
<p>处理器不再执行输入/输出指令，而是在主存中组织通道程序，由输入/输出通道执行。</p>
<h5 id="输入输出通道的工作流程">输入/输出通道的工作流程</h5>
<ol type="1">
<li>CPU遇到输入/输出任务，组织通道程序，置通道程序地址字CAW，启动指定通道</li>
<li>通道从CAW获得通道程序，控制输入/输出设备进行操作，CPU执行其他任务</li>
<li>输入/输出操作完成后，输入/输出通道发出中断，CPU处理中断，并从通道程序状态字CSW获得通道执行情况，处理输入/输出操作</li>
</ol>
<ul>
<li>CPU与通道高度并行工作</li>
</ul>
<h3 id="总线与输入输出">4.1.3 总线与输入/输出</h3>
<h4 id="总线对输入输出的影响">1. 总线对输入/输出的影响</h4>
<ul>
<li>输入/输出和CPU速度不匹配、各设备输入/输出速度不匹配</li>
<li>总线使主机和设备充分并行，提高系统效率</li>
</ul>
<h4 id="几种经典总线模型">2. 几种经典总线模型</h4>
<h5 id="单总线结构模型">单总线结构模型</h5>
<p>将CPU、主存和输入/输出模块连接到同一总线</p>
<ul>
<li><p>优点：结构简单、易于扩充</p></li>
<li><p>缺点：设备多时总线压力大，传输时间延长，慢速外设占用带宽多</p></li>
</ul>
<h5 id="三级总线模型">三级总线模型</h5>
<p>主存和Cache通过主存总线连接，主存总线和扩展总线上的输入/输出设备通过扩展总线接口缓冲</p>
<ul>
<li>优点：主存和输入/输出之间的数据传送、处理器的内存活动分离，可以支持更多输入/输出设备</li>
<li>缺点：不适用于输入/输出设备数据速率相差太大的情形</li>
</ul>
<h5
id="南桥输入输出控制器与北桥主存控制器">南桥（输入/输出控制器）与北桥（主存控制器）</h5>
<p>通过存储总线、PCI总线、E(ISA)总线分别连接主存、高速输入/输出设备和低速输入/输出设备。</p>
<p>优点：可以支持不同数据速率的输入输出设备。</p>
<pre><code class=" mermaid">graph LR
	CPU--处理器总线---北桥--存储总线---Cache
	北桥--桥间接口---南桥
	南桥---PCI总线---E总线
</code></pre>
<h5 id="一种基于通道的服务器总线模型">一种基于通道的服务器总线模型</h5>
<p>支持CPU、主存和多个输入/输出通道之间的数据传送</p>
<p>支持输入/输出通道和输入/输出控制器，以及输入/输出控制器和设备之间的数据传送。</p>
<ul>
<li>CPU通过主存控制器连接主存</li>
<li>CPU、主存和主存控制器均连接在一条与各个输入/输出通道连接的总线上</li>
<li>各个输入/输出通道分别与负责的输入/输出控制器连接</li>
<li>各个输入/输出控制器分别与负责的设备连接</li>
</ul>
<h2 id="设备管理软件">4.2 设备管理软件</h2>
<h3 id="输入输出软件的实现层次">4.2.1 输入/输出软件的实现层次</h3>
<h4 id="输入输出软件的设计">1. 输入/输出软件的设计</h4>
<p>设计目标：</p>
<ul>
<li>高效率：改善设备效率，尤其是磁盘输入/输出操作的效率</li>
<li>通用性：用统一标准来管理所有设备</li>
</ul>
<p>设计思路：</p>
<ul>
<li>把软件组织成层次结构，底层软件用来屏蔽硬件细节，高层软件向用户提供简洁、友善、统一的界面</li>
</ul>
<p>设计需要考虑的问题：</p>
<ul>
<li>设备无关性：访问设备的程序与具体设备无关</li>
<li>出错处理：低层软件能处理的错误不让高层软件感知</li>
<li>同步/异步传输：支持阻塞和中断驱动两种工作方式</li>
<li>缓冲技术：建立内存数据缓冲区，提高吞吐量</li>
</ul>
<h4 id="输入输出软件的实现层次-1">2. 输入/输出软件的实现层次</h4>
<p>从低到高有：</p>
<ol type="1">
<li>输入/输出硬件：执行输入/输出操作</li>
<li>输入/输出中断处理程序：处理输入/输出中断，报告输入/输出错误，唤醒输入/输出设备驱动程序</li>
<li>输入/输出设备驱动程序：设备寄存器初始化，启动输入/输出操作，检查输入/输出状态</li>
<li>独立于设备的输入/输出软件：设备的命名、保护、阻塞、缓冲、分配、跟踪</li>
<li>用户空间的输入/输出软件：输入/输出系统调研、输入/输出格式化、SPOOLing</li>
</ol>
<h3 id="输入输出软件的实现">4.2.2 输入/输出软件的实现</h3>
<h4 id="输入输出中断处理程序">1. 输入/输出中断处理程序</h4>
<p>输入/输出中断处理程序位于操作系统底层，与硬件设备密切相关，与系统其余部分尽可能少地发生联系。</p>
<ul>
<li>进程请求输入/输出操作时，通常被阻塞</li>
<li>数据传输结束后产生输入/输出中断</li>
<li>CPU响应请求并转入中断处理程序</li>
</ul>
<h5 id="输入输出中断处理程序的功能">输入/输出中断处理程序的功能</h5>
<p>检查设备状态寄存器，判断中断原因，根据输入/输出操作完成情况进行相应处理</p>
<ul>
<li>如果数据传输有误，向上层软件报告设备出错信息，实施重新执行</li>
<li>如果正常结束，唤醒等待传输的进程，使其转换为就绪态</li>
<li>如果有等待传输的输入/输出命令，通知相应软件开启下一个输入/输出请求</li>
</ul>
<h4 id="设备驱动程序">2. 设备驱动程序</h4>
<ul>
<li>包括与设备密切相关的所有代码</li>
<li>从独立于设备的软件中接受输入/输出请求</li>
<li>把用户提交的逻辑输入/输出请求转化为物理输入/输出操作的启动和执行</li>
<li>监督设备是否正确执行，访问数据缓冲区，进行必要的纠错处理</li>
</ul>
<h5 id="设备驱动程序的功能">设备驱动程序的功能</h5>
<ul>
<li>设备初始化：在设备传输数据时，预置设备、控制器以及通道状态</li>
<li>执行设备驱动例程：负责启动设备，进行数据传输；对于通道，负责组织通道程序，启动通道工作</li>
<li>执行与设备相关的具体中断处理，负责处理设备、控制器及通道所发出的各种具体中断</li>
</ul>
<h5 id="设备驱动程序的层次">设备驱动程序的层次</h5>
<p>每个设备驱动程序原则上只处理一种设备，或者一类紧密相关的设备。</p>
<p>设备驱动程序的分层实现：</p>
<ul>
<li>高层/处理类设备，底层/处理具体设备</li>
<li>系统建立栈，接到输入/输出请求时先调用栈顶的驱动程序，然后继续向下调用底层驱动程序，直至所有物理操作被处理</li>
<li>这一方式使设备驱动的实现结构清晰，易于移植，但会增加一部分系统开销</li>
</ul>
<h4 id="独立于设备的输入输出软件">3. 独立于设备的输入/输出软件</h4>
<p>执行适用于所有设备的常用输入/输出功能，并向用户层软件提供一致性接口，包括：</p>
<ul>
<li>设备命名：通过路径名寻址设备</li>
<li>设备保护：用户是否有权访问设备</li>
<li>提供与设备无关的数据单位：字符、块</li>
<li>缓冲技术：调整CPU与输入/输出速度不匹配</li>
<li>分配和状态跟踪：分配设备</li>
<li>错误处理与报告：驱动无法处理的错误</li>
</ul>
<h4 id="用户空间的输入输出软件">4. 用户空间的输入/输出软件</h4>
<ul>
<li>库函数：操作系统内核外，使用库函数实现的输入/输出软件，运行时与应用程序链接</li>
<li>虚拟设备：用一类设备模拟另一类设备的仿真输入/输出软件</li>
</ul>
<h3 id="输入输出缓冲">4.2.3 输入/输出缓冲</h3>
<h4 id="输入输出缓冲-1">1. 输入/输出缓冲</h4>
<h5 id="设置输入输出缓冲的目的">设置输入/输出缓冲的目的</h5>
<ul>
<li>解决CPU与设备之间速度不匹配的矛盾</li>
<li>协调逻辑记录大小和物理记录大小不一致的问题</li>
<li>提高CPU和设备的并行性</li>
<li>减少输入/输出操作对CPU的中断次数</li>
<li>放宽对CPU中断响应时间的要求</li>
</ul>
<h5 id="输入输出缓冲区">输入/输出缓冲区</h5>
<p>在内存中开辟的存储区，专门用于临时存放输入/输出操作的数据</p>
<p>操作过程：</p>
<ul>
<li>写操作：将数据送至缓冲区，直到写满或需要写出，待适当时候系统将缓冲区内容写到设备上</li>
<li>读操作：系统将设备上的物理记录读至缓冲区，根据要求将当前所需要的数据从缓冲区中读出并传送给进程</li>
</ul>
<h4 id="几种缓冲技术">2. 几种缓冲技术</h4>
<h5 id="单缓冲技术">单缓冲技术</h5>
<p>操作系统在主存系统区中开设一个缓冲区。</p>
<ul>
<li>输入：先把数据读至缓冲区，再把缓冲区数据送至用户区，应用程序处理数据，如此往复，系统继续读入后续数据</li>
<li>输出，把数据从用户区传送至缓冲区，再将数据输出至设备，应用程序继续请求输出</li>
</ul>
<h5 id="双缓冲技术">双缓冲技术</h5>
<p>操作系统在主存系统区开设两个缓冲区。</p>
<ul>
<li>输入：先把数据输入缓冲区1，再从缓冲区1把数据传到用户区，供应用程序处理（同时设备可将数据传送到缓冲区2）</li>
<li>输出：先将数据从用户区传送到缓冲区1，再将数据传送到设备（同时应用程序可将数据传送到缓冲区2）</li>
</ul>
<h5 id="循环缓冲技术">循环缓冲技术</h5>
<p>操作系统分配一组缓冲区，每个缓冲区有指向下一个缓冲区的链接指针，构成循环</p>
<ul>
<li>调节设备和进程速度不匹配的问题</li>
</ul>
<h2 id="独占型外围设备的分配">4.3 独占型外围设备的分配</h2>
<h3 id="设备独立性">4.3.1 设备独立性</h3>
<ul>
<li><p>用户通常不指定物理设备，而是指定逻辑设备，使得用户进程和物理设备分离，再通过其他途径建立逻辑设备和物理设备间的映射。</p></li>
<li><p>设备管理中需要将逻辑设备名转换为物理设备名，为此系统需要提供逻辑设备名和物理设备名的对应表以供转换使用</p></li>
</ul>
<h4 id="设备独立性的优点">设备独立性的优点</h4>
<ul>
<li>应用程序与具体物理设备无关，系统增减或变更设备时不需要修改原程序</li>
<li>易于应对各种输入/输出设备故障，提高系统的可靠性</li>
<li>增加设备分配的灵活性，有利于更加有效地利用设备资源，实现多道程序设计</li>
</ul>
<h3 id="独占型外围设备的分配-1">4.3.2 独占型外围设备的分配</h3>
<h4 id="设备分配方式">设备分配方式</h4>
<p>独占型外围设备：一次只能由一个进程独占使用</p>
<p>分配方式：</p>
<ul>
<li>静态分配：进程运行前申请
<ul>
<li>实现简单，能防止系统发生死锁，但会降低设备利用率</li>
</ul></li>
<li>动态分配：进程随用随申请
<ul>
<li>提高设备利用率</li>
</ul></li>
</ul>
<h4 id="设备分配的数据结构">设备分配的数据结构</h4>
<p>设备类表</p>
<ul>
<li>每类设备对应于设备类表中的一栏</li>
<li>包括设备类、总台数、空闲台数、设备表起始地址等</li>
<li>支持设备独立性</li>
</ul>
<p>设备表</p>
<ul>
<li>每类设备有各自的设备表，用来登记这类设备的每台物理设备</li>
<li>包括：物理设备名，逻辑设备名，占有设备的进程，分配标志，好/坏标志等</li>
</ul>
<h2 id="共享型外围设备的驱动">4.4 共享型外围设备的驱动</h2>
<h3 id="磁盘的物理结构">4.4.1 磁盘的物理结构</h3>
<h4 id="磁盘结构">1. 磁盘结构</h4>
<ul>
<li>磁盘一般由多个盘片组成</li>
<li>每个盘片一般由两个盘面</li>
<li>盘面包括多个同心圆结构的磁道，不同盘面上位于相同位置的磁道构成柱面</li>
<li>每个磁道分为固定多个扇区，相邻扇区组合成簇</li>
<li>物理块的地址：
<ul>
<li>柱面号，磁道号，扇区号</li>
<li>0面0道1扇区（此处面指磁头而不是柱面）</li>
</ul></li>
</ul>
<h4 id="磁盘读写数据的方式">2. 磁盘读写数据的方式</h4>
<p>读写数据时，磁头必须定位到指定磁道上的指定扇区的开始处，过程为：</p>
<ol type="1">
<li>寻道：控制移动臂到达指定柱面</li>
<li>旋转：等待要读写的扇区旋转到磁头下</li>
<li>选择磁头号，进行数据传送</li>
</ol>
<h4 id="磁盘存取时间">3. 磁盘存取时间</h4>
<p>磁盘完成数据读写所需要的时间，是寻道时间、旋转延迟、传送时间的总和。</p>
<p><span
class="math inline">\(T_a=T_s+\frac{1}{2r}+\frac{b}{rN}\)</span></p>
<p>其中，<span class="math inline">\(T_a\)</span>为存取时间，<span
class="math inline">\(T_s\)</span>为寻道时间，<span
class="math inline">\(r\)</span>为磁盘旋转速度（转/秒），<span
class="math inline">\(b\)</span>为要传送的字节数，<span
class="math inline">\(N\)</span>为一个磁道中的字节数。</p>
<h3 id="磁盘的驱动调度">4.4.2 磁盘的驱动调度</h3>
<p>磁盘可能同时接收到若干输入/输出请求，如果随机响应，性能会很差。</p>
<p>驱动调度：操作系统的磁盘调度策略，按照最佳次序执行处理访问磁盘的多个输入/输出请求，以减少磁盘访问的总处理时间。</p>
<p>驱动调度策略有移臂调度和旋转调度。</p>
<h4 id="移臂调度及其算法">移臂调度及其算法</h4>
<ul>
<li><p>目的：使移动臂的移动时间最短以减少寻道总时间</p></li>
<li><p>算法：</p>
<ul>
<li>先来先服务：移臂距离大，性能差</li>
<li>最短查找时间优先
<ul>
<li>先执行查找时间最短的请求，寻道性能较好</li>
<li>存在“饥饿”现象</li>
</ul></li>
<li>单向扫描：移动臂向一个方向扫描，归途不提供服务</li>
<li>双向扫描：移动臂向一个方向移动，到达最后一个柱面再向反方向移动</li>
<li>电梯调度：改进双向扫描，当前移动方向没有访问请求时就改变方向</li>
</ul></li>
</ul>
<h4 id="旋转调度及其策略">旋转调度及其策略</h4>
<p>目的：使旋转延迟的总时间最少</p>
<p>循环排序：</p>
<ul>
<li><p>通过优化输入/输出请求排序，在最少旋转圈数内完成位于同一柱面的访问请求</p></li>
<li><p>旋转位置测定硬件和多磁头同时读写技术有利于提高旋转调度的效率</p></li>
</ul>
<p>优化分布：</p>
<ul>
<li>通过信息在存储空间的排列方式来减少旋转延迟</li>
<li>交替排序：由于磁盘匀速旋转，可能处理当前扇区数据时，下个扇区已经跳过。因此，可对扇区间隔编号，交叉因子为n:1表示相邻编号间间隔n-1个扇区</li>
<li>相邻扇区集中成簇读写</li>
<li>按柱面集中存储数据，可以减少数据读写时的移臂操作</li>
</ul>
<h2 id="虚拟设备">4.5 虚拟设备</h2>
<h3 id="spooling系统">4.5.1 SPOOLing系统</h3>
<h4 id="虚拟设备-1">1. 虚拟设备</h4>
<p>使用一类物理设备模拟另一类物理设备的技术。</p>
<p>示例：</p>
<ul>
<li>内存模拟磁盘</li>
<li>块设备模拟字符设备</li>
<li>输入输出重定向</li>
</ul>
<h4 id="spooling系统-1">2. SPOOLing系统</h4>
<p>SPOOLing（Simultaneous Peripheral Operations
On-Line，外部设备联机并行操作），是关于慢速字符设备如何与计算机主机交换信息的一种技术，通常称为“假脱机技术”。</p>
<p>一个经典的SPOOLing系统：</p>
<ul>
<li>用高速的磁盘设备来模拟慢速的字符设备，缩短进程在内存中的驻留时间</li>
<li>慢速输出设备先输出到输出井</li>
<li>进程运行过程中只从输入井读入数据，只向输出井输出数据，使得全部输入/输出都基于磁盘</li>
<li>加快进程周转时间，提高系统吞吐量</li>
</ul>
<p>该系统的软件组成：</p>
<ul>
<li>预输入系统：预先把数据从输入设备传送到磁盘输入井</li>
<li>缓输出设备：把数据从磁盘输出并传送到输出设备</li>
<li>井管理程序：控制进程和井之间的数据交换（输入/输出重定向）</li>
</ul>
<p>打印SPOOLing系统：打印机守护进程和SPOOLing打印目录</p>
<ul>
<li>守护进程是唯一有特权使用打印机设备的进程</li>
<li>打印文件前，用户进程先产生完整的待输出文件，存放在打印目录下</li>
<li>打印机空闲时，启动守护进程，打印待输出文件</li>
</ul>
<h3 id="批处理系统的作业管理">4.5.2 批处理系统的作业管理</h3>
<ul>
<li>作业说明语言：用于作业控制的语言</li>
<li>作业说明书：刻画具体作业的控制方式</li>
<li>作业状态：输入状态（预输入）、后备状态（空闲）、运行状态（运行）、完成状态（缓输出）</li>
<li>作业调度：从后备状态作业中选择部分进入运行状态</li>
<li>作业调度算法：优先数、短作业、响应比、设备搭配等</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="category-chain-item">计算机操作系统</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/05/05/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E4%BA%94%E7%AB%A0%20%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" title="计算机操作系统-第五章_文件管理">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">计算机操作系统-第五章_文件管理</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/05/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E4%B8%89%E7%AB%A0%20%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/" title="计算机操作系统-第三章_存储管理">
                        <span class="hidden-mobile">计算机操作系统-第三章_存储管理</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.events.registerRefreshCallback(function() {
      if ('mermaid' in window) {
        mermaid.init();
      }
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <p>长风破浪会有时，直挂云帆济沧海</p> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
